# üèÜ –°–∏—Å—Ç–µ–º–∞ —Ç—É—Ä–Ω–∏—Ä–æ–≤

## –û–±–∑–æ—Ä

–ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ç—É—Ä–Ω–∏—Ä–æ–≤ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—É—é –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–π –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏. –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã —Ç—É—Ä–Ω–∏—Ä–æ–≤, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ç–æ–∫ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ç—á–∞–º–∏.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

1. **Tournament** - –æ—Å–Ω–æ–≤–Ω–∞—è –º–æ–¥–µ–ª—å —Ç—É—Ä–Ω–∏—Ä–∞
2. **TournamentMatch** - –º–æ–¥–µ–ª—å –º–∞—Ç—á–∞ –≤ —Ç—É—Ä–Ω–∏—Ä–µ
3. **GameParticipant** - —É—á–∞—Å—Ç–Ω–∏–∫ —Ç—É—Ä–Ω–∏—Ä–∞
4. **TournamentController** - API –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
5. **Tournament Routes** - API –º–∞—Ä—à—Ä—É—Ç—ã

### –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```
tournaments
‚îú‚îÄ‚îÄ id (UUID, PK)
‚îú‚îÄ‚îÄ name (STRING)
‚îú‚îÄ‚îÄ description (TEXT)
‚îú‚îÄ‚îÄ type (ENUM: single_elimination, double_elimination, round_robin, swiss)
‚îú‚îÄ‚îÄ status (ENUM: preparing, registering, active, completed, cancelled)
‚îú‚îÄ‚îÄ max_participants (INTEGER)
‚îú‚îÄ‚îÄ entry_fee_coins (INTEGER)
‚îú‚îÄ‚îÄ prize_pool (INTEGER)
‚îú‚îÄ‚îÄ start_date (DATE)
‚îú‚îÄ‚îÄ end_date (DATE)
‚îú‚îÄ‚îÄ creator_id (UUID, FK -> users)
‚îî‚îÄ‚îÄ metadata (JSONB)

tournament_matches
‚îú‚îÄ‚îÄ id (UUID, PK)
‚îú‚îÄ‚îÄ tournament_id (UUID, FK -> tournaments)
‚îú‚îÄ‚îÄ round (INTEGER)
‚îú‚îÄ‚îÄ position (INTEGER)
‚îú‚îÄ‚îÄ participant1_id (UUID, FK -> game_participants)
‚îú‚îÄ‚îÄ participant2_id (UUID, FK -> game_participants)
‚îú‚îÄ‚îÄ winner_id (UUID, FK -> game_participants)
‚îú‚îÄ‚îÄ status (ENUM: pending, waiting, active, completed)
‚îú‚îÄ‚îÄ game_room_id (UUID, FK -> game_rooms)
‚îî‚îÄ‚îÄ metadata (JSONB)
```

## üîÑ –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª —Ç—É—Ä–Ω–∏—Ä–∞

### 1. –°–æ–∑–¥–∞–Ω–∏–µ (preparing)
- –¢—É—Ä–Ω–∏—Ä —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤ —Å—Ç–∞—Ç—É—Å–µ `preparing`
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: —Ç–∏–ø, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, –ø—Ä–∏–∑–æ–≤–æ–π —Ñ–æ–Ω–¥

### 2. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è (registering)
- –¢—É—Ä–Ω–∏—Ä –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ —Å—Ç–∞—Ç—É—Å `registering`
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ –∏–ª–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏

### 3. –ê–∫—Ç–∏–≤–Ω—ã–π (active)
- –¢—É—Ä–Ω–∏—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ `start()`
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å–µ—Ç–∫–∞ –º–∞—Ç—á–µ–π
- –ú–∞—Ç—á–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç –ø–æ –æ—á–µ—Ä–µ–¥–∏

### 4. –ó–∞–≤–µ—Ä—à–µ–Ω (completed)
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ–±–µ–¥–∏—Ç–µ–ª—å
- –í—ã–ø–ª–∞—á–∏–≤–∞—é—Ç—Å—è –ø—Ä–∏–∑–æ–≤—ã–µ
- –¢—É—Ä–Ω–∏—Ä –∞—Ä—Ö–∏–≤–∏—Ä—É–µ—Ç—Å—è

## üéØ –¢–∏–ø—ã —Ç—É—Ä–Ω–∏—Ä–æ–≤

### Single Elimination
- –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∞ –≤—ã–±—ã–≤–∞–Ω–∏–µ
- –ü–æ–±–µ–¥–∏—Ç–µ–ª—å –∫–∞–∂–¥–æ–≥–æ –º–∞—Ç—á–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç –¥–∞–ª—å—à–µ
- –ü—Ä–æ–∏–≥—Ä–∞–≤—à–∏–π –≤—ã–±—ã–≤–∞–µ—Ç

### Double Elimination
- Winners bracket + Losers bracket
- –£—á–∞—Å—Ç–Ω–∏–∫ –≤—ã–±—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –¥–≤—É—Ö –ø–æ—Ä–∞–∂–µ–Ω–∏–π
- –°–ª–æ–∂–Ω–∞—è, –Ω–æ —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–∞—è —Å–∏—Å—Ç–µ–º–∞

### Round Robin
- –ö–∞–∂–¥—ã–π –∏–≥—Ä–∞–µ—Ç —Å –∫–∞–∂–¥—ã–º
- –ü–æ–±–µ–∂–¥–∞–µ—Ç —É—á–∞—Å—Ç–Ω–∏–∫ —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–æ–±–µ–¥
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö —Ç—É—Ä–Ω–∏—Ä–æ–≤

### Swiss
- –°–∏—Å—Ç–µ–º–∞ —Å —Ä–µ–π—Ç–∏–Ω–≥–æ–º
- –£—á–∞—Å—Ç–Ω–∏–∫–∏ –∏–≥—Ä–∞—é—Ç —Å —Ä–∞–≤–Ω—ã–º–∏ –ø–æ —Å–∏–ª–µ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞–º–∏
- –†–µ–π—Ç–∏–Ω–≥ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Ç—É—Ä–∞

## üöÄ API Endpoints

### –¢—É—Ä–Ω–∏—Ä—ã
- `GET /tournaments` - —Å–ø–∏—Å–æ–∫ —Ç—É—Ä–Ω–∏—Ä–æ–≤
- `POST /tournaments` - —Å–æ–∑–¥–∞—Ç—å —Ç—É—Ä–Ω–∏—Ä
- `GET /tournaments/:id` - –ø–æ–ª—É—á–∏—Ç—å —Ç—É—Ä–Ω–∏—Ä
- `PUT /tournaments/:id` - –æ–±–Ω–æ–≤–∏—Ç—å —Ç—É—Ä–Ω–∏—Ä
- `POST /tournaments/:id/start` - –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç—É—Ä–Ω–∏—Ä

### –£—á–∞—Å—Ç–∏–µ
- `POST /tournaments/:id/register` - –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
- `DELETE /tournaments/:id/register` - –æ—Ç–º–µ–Ω–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é

### –ú–∞—Ç—á–∏
- `GET /tournaments/:id/matches` - —Å–ø–∏—Å–æ–∫ –º–∞—Ç—á–µ–π
- `GET /tournaments/:id/matches/:matchId` - –ø–æ–ª—É—á–∏—Ç—å –º–∞—Ç—á
- `POST /tournaments/:id/matches/:matchId/ready` - –≥–æ—Ç–æ–≤ –∫ –º–∞—Ç—á—É
- `POST /tournaments/:id/matches/:matchId/start` - –Ω–∞—á–∞—Ç—å –º–∞—Ç—á
- `POST /tournaments/:id/matches/:matchId/complete` - –∑–∞–≤–µ—Ä—à–∏—Ç—å –º–∞—Ç—á

### –õ–æ–±–±–∏
- `GET /tournaments/:id/lobby` - —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–∞
- `GET /tournaments/:id/participants` - —É—á–∞—Å—Ç–Ω–∏–∫–∏
- `GET /tournaments/:id/stats` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

## üéÆ Match Lobby System

### –°–æ—Å—Ç–æ—è–Ω–∏—è –º–∞—Ç—á–∞
1. **pending** - –º–∞—Ç—á —Å–æ–∑–¥–∞–Ω, –∂–¥–µ—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
2. **waiting** - –æ–±–∞ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –≥–æ—Ç–æ–≤—ã, –º–æ–∂–Ω–æ –Ω–∞—á–∏–Ω–∞—Ç—å
3. **active** - –º–∞—Ç—á –∏–¥–µ—Ç
4. **completed** - –º–∞—Ç—á –∑–∞–≤–µ—Ä—à–µ–Ω

### –ü—Ä–æ—Ü–µ—Å—Å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
1. –£—á–∞—Å—Ç–Ω–∏–∫ –≤—ã–∑—ã–≤–∞–µ—Ç `/ready` endpoint
2. –°–∏—Å—Ç–µ–º–∞ –æ—Ç–º–µ—á–∞–µ—Ç —É—á–∞—Å—Ç–Ω–∏–∫–∞ –∫–∞–∫ –≥–æ—Ç–æ–≤–æ–≥–æ
3. –ö–æ–≥–¥–∞ –æ–±–∞ –≥–æ—Ç–æ–≤—ã, –º–∞—Ç—á –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ —Å—Ç–∞—Ç—É—Å `waiting`
4. –ú–∞—Ç—á –º–æ–∂–Ω–æ –Ω–∞—á–∏–Ω–∞—Ç—å

## üîß –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –°–æ–∑–¥–∞–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–∞
```javascript
const tournament = await Tournament.createTournament({
  name: '–ú–æ–π —Ç—É—Ä–Ω–∏—Ä',
  type: 'single_elimination',
  max_participants: 16,
  entry_fee_coins: 100,
  prize_pool: 1000
});
```

### –ó–∞–ø—É—Å–∫ —Ç—É—Ä–Ω–∏—Ä–∞
```javascript
await tournament.start(); // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–µ—Ç–∫—É
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
```javascript
const state = await tournament.getTournamentState();
console.log(`–†–∞—É–Ω–¥ ${state.currentRound} –∏–∑ ${state.totalRounds}`);
```

### –ü—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
```javascript
await tournament.advanceWinner(matchId, winnerId);
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç:
```bash
node server/scripts/test-tournament-bracket.js
```

## üìù –ú–∏–≥—Ä–∞—Ü–∏–∏

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã `tournament_matches`:
```bash
npx sequelize-cli db:migrate
```

## üîÆ –ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è

- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å WebSocket –¥–ª—è real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ GameRoom –¥–ª—è –º–∞—Ç—á–µ–π
- [ ] –°–∏—Å—Ç–µ–º–∞ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ –∏ —Å–µ–∑–æ–Ω–Ω—ã—Ö —Ç—É—Ä–Ω–∏—Ä–æ–≤
- [ ] –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ —Ç—É—Ä–Ω–∏—Ä–æ–≤
- [ ] –°–∏—Å—Ç–µ–º–∞ –ø—Ä–∏–∑–æ–≤ –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
