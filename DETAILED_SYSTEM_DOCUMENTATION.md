# üìö LoveMemory - –ü–æ–¥—Ä–æ–±–Ω–∞—è –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

**–ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã –∏ –∏—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π**

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã](#–æ–±–∑–æ—Ä-—Å–∏—Å—Ç–µ–º—ã)
2. [Client (–§—Ä–æ–Ω—Ç–µ–Ω–¥)](#client-—Ñ—Ä–æ–Ω—Ç–µ–Ω–¥)
3. [Server (–ë—ç–∫–µ–Ω–¥)](#server-–±—ç–∫–µ–Ω–¥)
4. [AI (–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç)](#ai-–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π-–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç)
5. [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ](#–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-–∏-–≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ)

---

## üéØ –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã

**LoveMemory** - —ç—Ç–æ –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–π –≤ –ø–∞—Ä–∞—Ö, –æ–±—ä–µ–¥–∏–Ω—è—é—â–∞—è –∏–≥—Ä—ã, —Å–æ–±—ã—Ç–∏—è, AI-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∏ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏.

### üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ
‚îÇ     CLIENT      ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ     SERVER      ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ       AI        ‚îÇ
‚îÇ   (React App)   ‚îÇ    ‚îÇ  (Node.js API)  ‚îÇ    ‚îÇ  (Python ML)    ‚îÇ
‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                       ‚îÇ                       ‚îÇ
         ‚îÇ                       ‚îÇ                       ‚îÇ
     WebSocket                  REST API              FastAPI
    Real-time                 PostgreSQL            ML Models
   Gaming/Chat                  Redis               Recommendations
```

### üì¶ –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
- **Frontend**: React 19.1 + TypeScript + Redux Toolkit + Vite
- **Backend**: Node.js + Express 5.1 + PostgreSQL + Redis + Socket.io
- **AI**: Python + FastAPI + scikit-learn + LightGBM + Transformers

---

## üé® Client (–§—Ä–æ–Ω—Ç–µ–Ω–¥)

### üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–∫–∏ `client/`

```
client/
‚îú‚îÄ‚îÄ üìÑ package.json          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ üîß vite.config.js        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–±–æ—Ä—â–∏–∫–∞ Vite
‚îú‚îÄ‚îÄ üìù tsconfig.json         # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ TypeScript
‚îú‚îÄ‚îÄ üéØ index.html            # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ HTML
‚îú‚îÄ‚îÄ üìÅ dist/                 # –°–æ–±—Ä–∞–Ω–Ω—ã–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ üìÅ public/               # –ü—É–±–ª–∏—á–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã
‚îî‚îÄ‚îÄ üìÅ src/                  # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    ‚îú‚îÄ‚îÄ üìÑ App.tsx           # –ö–æ—Ä–Ω–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
    ‚îú‚îÄ‚îÄ üìÑ AppRoutes.tsx     # –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è
    ‚îú‚îÄ‚îÄ üìÑ main.tsx          # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    ‚îú‚îÄ‚îÄ üìÅ modules/          # –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
    ‚îú‚îÄ‚îÄ üìÅ shared/           # –û–±—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
    ‚îú‚îÄ‚îÄ üìÅ store/            # –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    ‚îú‚îÄ‚îÄ üìÅ services/         # API —Å–µ—Ä–≤–∏—Å—ã
    ‚îú‚îÄ‚îÄ üìÅ components/       # –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
    ‚îú‚îÄ‚îÄ üìÅ context/          # React –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã
    ‚îî‚îÄ‚îÄ üìÅ ui/               # UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
```

### üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

#### 1. **–ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**
–ö–∞–∂–¥—ã–π –º–æ–¥—É–ª—å –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–≤–æ—é –ª–æ–≥–∏–∫—É:

```
modules/
‚îú‚îÄ‚îÄ auth/              # –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ components/    # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –º–æ–¥—É–ª—è
‚îÇ   ‚îú‚îÄ‚îÄ hooks/         # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –≤ —Ö—É–∫–∞—Ö
‚îÇ   ‚îú‚îÄ‚îÄ pages/         # –°—Ç—Ä–∞–Ω–∏—Ü—ã –º–æ–¥—É–ª—è
‚îÇ   ‚îú‚îÄ‚îÄ services/      # API —Å–µ—Ä–≤–∏—Å—ã –º–æ–¥—É–ª—è
‚îÇ   ‚îú‚îÄ‚îÄ store/         # –õ–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ types/         # TypeScript —Ç–∏–ø—ã
‚îú‚îÄ‚îÄ games/             # –ò–≥—Ä–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞
‚îú‚îÄ‚îÄ events/            # –°–æ–±—ã—Ç–∏—è –∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—å
‚îú‚îÄ‚îÄ users/             # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
‚îú‚îÄ‚îÄ dashboard/         # –ì–ª–∞–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å
‚îî‚îÄ‚îÄ education/         # –û–±—É—á–∞—é—â–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã
```

#### 2. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏**

**üéØ Pages** - –¢–æ–Ω–∫–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è —Ä–æ—É—Ç–∏–Ω–≥–∞:
```tsx
// –¢–æ–ª—å–∫–æ –∫–æ–º–ø–æ–∑–∏—Ü–∏—è, –Ω–∏–∫–∞–∫–æ–π –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
const GamesPage = () => {
  return <GamesModule userId={user.id} />
}
```

**üè¢ Modules** - –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –º–æ–¥—É–ª–µ–π:
```tsx
// –í—Å—è –ª–æ–≥–∏–∫–∞ –≤ —Ö—É–∫–∞—Ö
const GamesModule = ({ userId }) => {
  const games = useGameLobby(gameType)
  return <GamesUI {...games} />
}
```

**üß© Components** - "–ì–ª—É–ø—ã–µ" UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
```tsx
// –¢–æ–ª—å–∫–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –Ω–∏–∫–∞–∫–æ–π –ª–æ–≥–∏–∫–∏
const GameCard = ({ title, players, onJoin }) => (
  <div>
    <h3>{title}</h3>
    <button onClick={onJoin}>–ò–≥—Ä–∞—Ç—å</button>
  </div>
)
```

#### 3. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º**

**Redux Toolkit** –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è:
```typescript
// store/slices/gameSlice.ts
export const gameSlice = createSlice({
  name: 'game',
  initialState: {
    currentRoom: null,
    isConnected: false,
    gameState: null
  },
  reducers: {
    setCurrentRoom: (state, action) => {
      state.currentRoom = action.payload
    }
  }
})
```

**React Hooks** –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è:
```typescript
// –í—Å—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –≤ —Ö—É–∫–∞—Ö
export const useGameLobby = (gameType: string) => {
  const [rooms, setRooms] = useState([])
  const [loading, setLoading] = useState(false)
  
  const joinGame = useCallback(async (gameId) => {
    // –õ–æ–≥–∏–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∏–≥—Ä–µ
  }, [])
  
  return { rooms, loading, joinGame }
}
```

### üåê –ö–ª—é—á–µ–≤—ã–µ –º–æ–¥—É–ª–∏

#### 1. **Games Module** üéÆ
–ü–æ–ª–Ω–∞—è –∏–≥—Ä–æ–≤–∞—è —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞:

```
games/
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ ChessBoard/           # –®–∞—Ö–º–∞—Ç–Ω–∞—è –¥–æ—Å–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ TicTacToeBoard/       # –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ PokerTable/           # –ü–æ–∫–µ—Ä–Ω—ã–π —Å—Ç–æ–ª
‚îÇ   ‚îî‚îÄ‚îÄ GameLobby/            # –õ–æ–±–±–∏ –∏–≥—Ä
‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îú‚îÄ‚îÄ useGameSocket.ts      # WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ usePokerGame.ts       # –õ–æ–≥–∏–∫–∞ –ø–æ–∫–µ—Ä–∞
‚îÇ   ‚îî‚îÄ‚îÄ useGameLobby.ts       # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–±–±–∏
‚îú‚îÄ‚îÄ modules/
‚îÇ   ‚îú‚îÄ‚îÄ ChessModule/          # –®–∞—Ö–º–∞—Ç–Ω—ã–π –º–æ–¥—É–ª—å
‚îÇ   ‚îú‚îÄ‚îÄ PokerModule/          # –ü–æ–∫–µ—Ä–Ω—ã–π –º–æ–¥—É–ª—å
‚îÇ   ‚îî‚îÄ‚îÄ TournamentModule/     # –¢—É—Ä–Ω–∏—Ä—ã
‚îî‚îÄ‚îÄ services/
    ‚îî‚îÄ‚îÄ game.service.js       # API –¥–ª—è –∏–≥—Ä
```

**WebSocket –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**:
```typescript
const usePokerGame = (roomId: string) => {
  const socketRef = useRef<Socket | null>(null)
  
  useEffect(() => {
    const socket = io(SOCKET_URL, {
      auth: { token: user.token },
      transports: ['websocket', 'polling']
    })
    
    socket.on('game_update', (gameState) => {
      setGameState(gameState)
    })
    
    socketRef.current = socket
  }, [roomId])
  
  const makeMove = useCallback((action, value) => {
    socketRef.current?.emit('make_move', { 
      roomId, action, value 
    })
  }, [roomId])
}
```

#### 2. **Events Module** üìÖ
–ö–∞–ª–µ–Ω–¥–∞—Ä—å –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è–º–∏:

```
events/
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ Calendar/             # –ö–∞–ª–µ–Ω–¥–∞—Ä—å —Å–æ–±—ã—Ç–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ EventCard/            # –ö–∞—Ä—Ç–æ—á–∫–∞ —Å–æ–±—ã—Ç–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ EventFilters/         # –§–∏–ª—å—Ç—Ä—ã —Å–æ–±—ã—Ç–∏–π
‚îú‚îÄ‚îÄ modules/
‚îÇ   ‚îú‚îÄ‚îÄ CalendarModule/       # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
‚îÇ   ‚îî‚îÄ‚îÄ DayDetailModule/      # –î–µ—Ç–∞–ª–∏ –¥–Ω—è
‚îî‚îÄ‚îÄ hooks/
    ‚îú‚îÄ‚îÄ useCalendar.ts        # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º
    ‚îî‚îÄ‚îÄ useEvents.ts          # –†–∞–±–æ—Ç–∞ —Å —Å–æ–±—ã—Ç–∏—è–º–∏
```

#### 3. **AI Module** ü§ñ
–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å AI —Å–µ—Ä–≤–∏—Å–∞–º–∏:

```
ai/
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ RecommendationList/   # –°–ø–∏—Å–æ–∫ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ ChatInterface/        # –ß–∞—Ç —Å AI
‚îÇ   ‚îî‚îÄ‚îÄ DateGenerator/        # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–≤–∏–¥–∞–Ω–∏–π
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îî‚îÄ‚îÄ ai.service.js         # API –¥–ª—è AI
‚îî‚îÄ‚îÄ hooks/
    ‚îú‚îÄ‚îÄ useRecommendations.ts # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
    ‚îî‚îÄ‚îÄ useAIChat.ts          # –ß–∞—Ç —Å AI
```

### üîß –°–µ—Ä–≤–∏—Å—ã –∏ API

**–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å API**:
```javascript
// services/api.js
class ApiClient {
  constructor() {
    this.baseURL = process.env.VITE_API_BASE_URL
    this.setupInterceptors()
  }
  
  async get(endpoint) {
    return await axios.get(`${this.baseURL}${endpoint}`)
  }
}

export default new ApiClient()
```

**–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã**:
```javascript
// services/game.service.js
export const gameService = {
  async getRooms(gameType) {
    return api.get(`/games/${gameType}/rooms`)
  },
  
  async createRoom(gameType, settings) {
    return api.post(`/games/${gameType}/rooms`, settings)
  }
}
```

---

## ‚öôÔ∏è Server (–ë—ç–∫–µ–Ω–¥)

### üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–∫–∏ `server/`

```
server/
‚îú‚îÄ‚îÄ üìÑ index.js              # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ —Å–µ—Ä–≤–µ—Ä–∞
‚îú‚îÄ‚îÄ üìÑ package.json          # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ —Å–∫—Ä–∏–ø—Ç—ã
‚îú‚îÄ‚îÄ üìÅ config/               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ database.js          # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ passport.js          # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ redis.js             # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Redis
‚îú‚îÄ‚îÄ üìÅ controllers/          # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
‚îú‚îÄ‚îÄ üìÅ models/               # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö (Sequelize)
‚îú‚îÄ‚îÄ üìÅ routes/               # –ú–∞—Ä—à—Ä—É—Ç—ã API
‚îú‚îÄ‚îÄ üìÅ services/             # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ üìÅ middleware/           # –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
‚îú‚îÄ‚îÄ üìÅ gameLogic/            # –ò–≥—Ä–æ–≤–∞—è –ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ üìÅ socket/               # WebSocket –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
‚îú‚îÄ‚îÄ üìÅ migrations/           # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
‚îî‚îÄ‚îÄ üìÅ uploads/              # –ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
```

### üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–µ—Ä–≤–µ—Ä–∞

#### 1. **MVC Pattern**

**Models** - –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö —Å Sequelize:
```javascript
// models/User.js
const User = sequelize.define('User', {
  id: { type: DataTypes.UUID, primaryKey: true },
  email: { type: DataTypes.STRING, unique: true },
  username: { type: DataTypes.STRING, unique: true },
  passwordHash: DataTypes.STRING,
  coins: { type: DataTypes.INTEGER, defaultValue: 0 }
})
```

**Controllers** - –û–±—Ä–∞–±–æ—Ç–∫–∞ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤:
```javascript
// controllers/game.controller.js
const gameController = {
  async getRooms(req, res) {
    try {
      const { gameType } = req.params
      const rooms = await gameService.getActiveRooms(gameType)
      res.json({ success: true, data: rooms })
    } catch (error) {
      res.status(500).json({ success: false, error: error.message })
    }
  }
}
```

**Routes** - –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è:
```javascript
// routes/game.routes.js
const router = express.Router()

router.get('/:gameType/rooms', authenticateToken, gameController.getRooms)
router.post('/:gameType/rooms', authenticateToken, gameController.createRoom)

module.exports = router
```

#### 2. **Service Layer Pattern**

**Services** —Å–æ–¥–µ—Ä–∂–∞—Ç –≤—Å—é –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É:
```javascript
// services/game.service.js
class GameService {
  async createRoom(gameType, settings, creatorId) {
    // –í–∞–ª–∏–¥–∞—Ü–∏—è
    if (!this.validateGameSettings(gameType, settings)) {
      throw new Error('Invalid game settings')
    }
    
    // –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã
    const room = await GameRoom.create({
      gameType,
      settings,
      creatorId,
      status: 'waiting'
    })
    
    // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ WebSocket
    io.emit('room_created', room)
    
    return room
  }
}
```

### üéÆ –ò–≥—Ä–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞

#### 1. **Game Logic Architecture**

```
gameLogic/
‚îú‚îÄ‚îÄ base/
‚îÇ   ‚îú‚îÄ‚îÄ BaseGame.ts          # –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –∏–≥—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ RealtimeGame.ts      # Real-time –∏–≥—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ TurnBasedGame.ts     # –ü–æ—à–∞–≥–æ–≤—ã–µ –∏–≥—Ä—ã
‚îÇ   ‚îî‚îÄ‚îÄ TeamGame.ts          # –ö–æ–º–∞–Ω–¥–Ω—ã–µ –∏–≥—Ä—ã
‚îú‚îÄ‚îÄ games/
‚îÇ   ‚îú‚îÄ‚îÄ ChessGame.ts         # –®–∞—Ö–º–∞—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ TicTacToeGame.ts     # –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ QuizGame.ts          # –í–∏–∫—Ç–æ—Ä–∏–Ω—ã
‚îî‚îÄ‚îÄ poker/
    ‚îú‚îÄ‚îÄ PokerGame.ts         # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø–æ–∫–µ—Ä–∞
    ‚îú‚îÄ‚îÄ PokerPlayer.ts       # –ò–≥—Ä–æ–∫ –≤ –ø–æ–∫–µ—Ä–µ
    ‚îî‚îÄ‚îÄ PokerHand.ts         # –ü–æ–∫–µ—Ä–Ω–∞—è —Ä—É–∫–∞
```

**–ë–∞–∑–æ–≤—ã–π –∏–≥—Ä–æ–≤–æ–π –∫–ª–∞—Å—Å**:
```typescript
// gameLogic/base/BaseGame.ts
export abstract class BaseGame {
  protected gameState: GameState
  protected players: Map<string, Player>
  
  abstract makeMove(playerId: string, move: any): GameState
  abstract isGameFinished(): boolean
  abstract getWinner(): string | null
  
  protected validateMove(playerId: string, move: any): boolean {
    // –û–±—â–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ö–æ–¥–æ–≤
  }
  
  protected notifyPlayers(event: string, data: any) {
    this.players.forEach(player => {
      io.to(player.socketId).emit(event, data)
    })
  }
}
```

**–ü–æ–∫–µ—Ä–Ω–∞—è –ª–æ–≥–∏–∫–∞**:
```typescript
// gameLogic/poker/PokerGame.ts
export class PokerGame extends TurnBasedGame {
  private deck: Card[]
  private pot: number = 0
  private communityCards: Card[] = []
  
  makeMove(playerId: string, action: PokerAction): GameState {
    const player = this.players.get(playerId)
    
    switch (action.type) {
      case 'fold':
        return this.handleFold(player)
      case 'call':
        return this.handleCall(player)
      case 'raise':
        return this.handleRaise(player, action.amount)
    }
  }
}
```

#### 2. **WebSocket Integration**

```javascript
// socket/index.js
const initSocket = (server) => {
  const io = new Server(server, {
    cors: { origin: allowedOrigins }
  })
  
  io.use(authenticateSocket) // Middleware –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
  
  io.on('connection', (socket) => {
    socket.on('join_room', async (roomId) => {
      const room = await gameService.joinRoom(roomId, socket.userId)
      socket.join(roomId)
      socket.emit('room_joined', room)
    })
    
    socket.on('make_move', async (data) => {
      const { roomId, action, value } = data
      const result = await gameService.makeMove(roomId, socket.userId, { action, value })
      io.to(roomId).emit('game_update', result)
    })
  })
  
  return io
}
```

### üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

#### 1. **JWT Authentication**
```javascript
// middleware/auth.middleware.js
const authenticateToken = (req, res, next) => {
  const token = req.header('Authorization')?.replace('Bearer ', '')
  
  if (!token) {
    return res.status(401).json({ message: 'Access denied' })
  }
  
  try {
    const decoded = jwt.verify(token, process.env.JWT_SECRET)
    req.user = decoded
    next()
  } catch (error) {
    res.status(403).json({ message: 'Invalid token' })
  }
}
```

#### 2. **Rate Limiting**
```javascript
// middleware/rateLimit.middleware.js
const createRateLimit = (windowMs, max) => rateLimit({
  windowMs,
  max,
  message: { error: 'Too many requests' },
  standardHeaders: true,
  legacyHeaders: false
})

const apiLimiter = createRateLimit(15 * 60 * 1000, 100) // 100 requests per 15 minutes
```

### üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

#### 1. **PostgreSQL —Å Sequelize**

**–ú–æ–¥–µ–ª–∏ –æ—Ç–Ω–æ—à–µ–Ω–∏–π**:
```javascript
// models/Pair.js
const Pair = sequelize.define('Pair', {
  id: { type: DataTypes.UUID, primaryKey: true },
  user1Id: { type: DataTypes.UUID, references: { model: 'Users' }},
  user2Id: { type: DataTypes.UUID, references: { model: 'Users' }},
  status: { type: DataTypes.ENUM('pending', 'active', 'ended') },
  createdAt: DataTypes.DATE
})

// –°–≤—è–∑–∏
User.hasMany(Pair, { as: 'InitiatedPairs', foreignKey: 'user1Id' })
User.hasMany(Pair, { as: 'ReceivedPairs', foreignKey: 'user2Id' })
```

#### 2. **Redis –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è**
```javascript
// config/redis.js
const redis = new Redis({
  host: process.env.REDIS_HOST || 'localhost',
  port: process.env.REDIS_PORT || 6379,
  retryDelayOnFailover: 100,
  maxRetriesPerRequest: 3
})

// –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–≥—Ä–æ–≤—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π
const cacheGameState = async (roomId, gameState) => {
  await redis.setex(`game:${roomId}`, 3600, JSON.stringify(gameState))
}
```

### ü§ñ AI Integration

#### 1. **AI Controller**
```javascript
// controllers/ai.controller.js
const handleChat = async (req, res) => {
  try {
    const { prompt } = req.body
    const userId = req.user.id
    
    // –í—ã–∑–æ–≤ AI Orchestrator
    const response = await aiOrchestrator.handleRequest(prompt, userId)
    
    res.json({
      success: true,
      data: {
        message: response.message,
        intent: response.intent,
        suggestions: response.suggestions
      }
    })
  } catch (error) {
    res.status(500).json({ success: false, error: error.message })
  }
}
```

#### 2. **Recommendation Controller**
```javascript
// controllers/recommendation.controller.js
class RecommendationController {
  async getRecommendations(req, res) {
    try {
      const { pairId, topK = 10 } = req.params
      
      // –í—ã–∑–æ–≤ Python AI —Å–µ—Ä–≤–∏—Å–∞
      const recommendations = await this.callPythonRecommender(pairId, topK)
      
      res.json({
        success: true,
        data: recommendations,
        metadata: { generatedAt: new Date() }
      })
    } catch (error) {
      res.status(500).json({ success: false, error: error.message })
    }
  }
  
  async callPythonRecommender(pairId, topK) {
    const AI_SERVICE_URL = process.env.AI_SERVICE_URL || 'http://localhost:8001'
    
    const response = await axios.post(`${AI_SERVICE_URL}/recommend`, {
      pair_id: pairId,
      top_k: topK,
      include_explanations: true
    })
    
    return response.data
  }
}
```

---

## üß† AI (–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç)

### üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–∫–∏ `ai/`

```
ai/
‚îú‚îÄ‚îÄ üìÑ main.py                        # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ FastAPI
‚îú‚îÄ‚îÄ üìÑ ultimate_ai_service.py         # –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π AI —Å–µ—Ä–≤–∏—Å
‚îú‚îÄ‚îÄ üìÑ requirements.txt               # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ üìÅ data/                          # –î–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ synthetic_v1/                 # –°–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ v1
‚îú‚îÄ‚îÄ üìÅ models/                        # –û–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ üìÅ notebooks/                     # Jupyter –Ω–æ—É—Ç–±—É–∫–∏
‚îú‚îÄ‚îÄ üìÑ content_recommender.py         # Content-based —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ üìÑ collaborative_filtering.py     # –ö–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ üìÑ embedding_service.py           # –í–µ–∫—Ç–æ—Ä–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è
‚îú‚îÄ‚îÄ üìÑ learning_to_rank_service.py    # Learning to Rank
‚îú‚îÄ‚îÄ üìÑ llm_wrapper.py                 # LLM –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ üìÑ explainability_service.py      # –û–±—ä—è—Å–Ω–∏–º–æ—Å—Ç—å AI
‚îú‚îÄ‚îÄ üìÑ context_awareness_engine.py    # –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –æ—Å–≤–µ–¥–æ–º–ª–µ–Ω–Ω–æ—Å—Ç—å
‚îú‚îÄ‚îÄ üìÑ personality_engine.py          # –õ–∏—á–Ω–æ—Å—Ç–Ω—ã–µ –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ üìÑ shared_memory_bank.py          # –ö–æ–ø–∏–ª–∫–∞ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–π
‚îî‚îÄ‚îÄ üìÑ monitoring_service.py          # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã
```

### üéØ AI –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

#### 1. **–ú–Ω–æ–≥–æ—Å–ª–æ–π–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                 Ultimate AI Service                      ‚îÇ
‚îÇ              (–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä)                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ             ‚îÇ                                     ‚îÇ
    ‚ñº             ‚ñº                                     ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇLearning ‚îÇ  ‚îÇEnhanced ‚îÇ  ‚îÇ   Content   ‚îÇ  ‚îÇCollaborative‚îÇ
‚îÇto Rank  ‚îÇ  ‚îÇ Hybrid  ‚îÇ  ‚îÇ   Based     ‚îÇ  ‚îÇ Filtering   ‚îÇ
‚îÇ(LightGBM‚îÇ  ‚îÇ         ‚îÇ  ‚îÇ             ‚îÇ  ‚îÇ   (SVD)     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    ‚îÇ             ‚îÇ              ‚îÇ              ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ              ‚îÇ
                  ‚ñº              ‚ñº
            ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
            ‚îÇ Embeddings  ‚îÇ  ‚îÇ    LLM      ‚îÇ
            ‚îÇ + ANN       ‚îÇ  ‚îÇ Generation  ‚îÇ
            ‚îÇ (Faiss)     ‚îÇ  ‚îÇ             ‚îÇ
            ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### 2. **Ultimate AI Service - –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Ö–∞–±**

```python
# ultimate_ai_service.py
class UltimateAIService:
    def __init__(self, data_path: str = 'data/synthetic_v1'):
        self.content_recommender = ContentBasedRecommender(data_path)
        self.cf_recommender = CollaborativeFilteringRecommender(data_path)
        self.embedding_service = EmbeddingService(data_path)
        self.ltr_service = LearningToRankService(data_path)
        self.llm_wrapper = LLMWrapper()
        self.explainer = ExplainabilityService()
        
        # –°—Ç–∞—Ç—É—Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
        self.components_status = {
            'content_based': False,
            'collaborative_filtering': False,
            'embeddings': False,
            'learning_to_rank': False,
            'llm_generation': False
        }
        
        # –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
        self.recommendation_cache = {}
        self.cache_ttl_seconds = 300
    
    async def get_recommendations(self, request: RecommendationRequest):
        """–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –º–µ—Ç–æ–¥–∞–º–∏"""
        
        # 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—ç—à
        cache_key = f"{request.pair_id}_{request.top_k}"
        if cache_key in self.recommendation_cache:
            return self.recommendation_cache[cache_key]
        
        # 2. –í—ã–±–∏—Ä–∞–µ–º –ª—É—á—à–∏–π –¥–æ—Å—Ç—É–ø–Ω—ã–π –º–µ—Ç–æ–¥
        recommendations = None
        
        if self.components_status['learning_to_rank']:
            # –õ—É—á—à–∏–π –º–µ—Ç–æ–¥ - Learning to Rank
            recommendations = await self._get_ltr_recommendations(request)
        elif self.components_status['collaborative_filtering']:
            # Fallback –∫ Enhanced Hybrid
            recommendations = await self._get_hybrid_recommendations(request)
        elif self.components_status['content_based']:
            # Fallback –∫ Content-based
            recommendations = await self._get_content_recommendations(request)
        else:
            # –ê–≤–∞—Ä–∏–π–Ω—ã–π fallback
            recommendations = self._get_fallback_recommendations(request)
        
        # 3. –ö—ç—à–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        self.recommendation_cache[cache_key] = recommendations
        
        return recommendations
```

### üî¨ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã AI —Å–∏—Å—Ç–µ–º—ã

#### 1. **Content-Based Recommender**

```python
# content_recommender.py
class ContentBasedRecommender:
    def __init__(self, data_path: str):
        self.users_df = pd.read_csv(f"{data_path}/users.csv")
        self.products_df = pd.read_csv(f"{data_path}/product_catalog.csv")
        
    def recommend(self, pair_id: str, top_k: int = 10):
        """–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤"""
        
        # –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–∞—Ä—ã
        pair_data = self._get_pair_data(pair_id)
        
        # –í—ã—á–∏—Å–ª—è–µ–º —Å–∫–æ—Ä—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞
        scores = []
        for _, product in self.products_df.iterrows():
            score = self._calculate_content_score(pair_data, product)
            scores.append({
                'product_id': product['id'],
                'score': score,
                'explanation': self._explain_score(pair_data, product)
            })
        
        # –°–æ—Ä—Ç–∏—Ä—É–µ–º –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–æ–ø-K
        scores.sort(key=lambda x: x['score'], reverse=True)
        return scores[:top_k]
    
    def _calculate_content_score(self, pair_data, product):
        """Weighted scoring: interests(60%) + distance(20%) + price(20%)"""
        
        # 1. –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤
        interest_score = self._calculate_interest_overlap(
            pair_data['interests'], product['tags']
        )
        
        # 2. –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –±–ª–∏–∑–æ—Å—Ç—å
        distance_score = self._calculate_distance_score(
            pair_data['location'], (product['latitude'], product['longitude'])
        )
        
        # 3. –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –±—é–¥–∂–µ—Ç—É
        price_score = self._calculate_price_match(
            pair_data['budget'], product['price']
        )
        
        # –í–∑–≤–µ—à–µ–Ω–Ω–∞—è —Å—É–º–º–∞
        total_score = (
            interest_score * 0.6 +
            distance_score * 0.2 +
            price_score * 0.2
        )
        
        return total_score
```

#### 2. **Collaborative Filtering**

```python
# collaborative_filtering.py
class CollaborativeFilteringRecommender:
    def __init__(self, data_path: str):
        self.interactions_df = pd.read_csv(f"{data_path}/interactions.csv")
        self.model = TruncatedSVD(n_components=5, random_state=42)
        self._train_model()
    
    def _train_model(self):
        """–û–±—É—á–µ–Ω–∏–µ SVD –º–æ–¥–µ–ª–∏"""
        
        # –°–æ–∑–¥–∞–µ–º user-item –º–∞—Ç—Ä–∏—Ü—É
        user_item_matrix = self.interactions_df.pivot_table(
            index='pair_id', 
            columns='product_id', 
            values='rating',
            fill_value=0
        )
        
        # –û–±—É—á–∞–µ–º SVD
        self.model.fit(user_item_matrix)
        self.user_item_matrix = user_item_matrix
        
        # –ö—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è
        scores = cross_val_score(self.model, user_item_matrix, cv=5)
        print(f"CV Score: {scores.mean():.3f} (+/- {scores.std() * 2:.3f})")
    
    def recommend(self, pair_id: str, top_k: int = 10):
        """CF —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ–º —Ä–µ–π—Ç–∏–Ω–≥–æ–≤"""
        
        if pair_id not in self.user_item_matrix.index:
            return self._handle_cold_start(pair_id, top_k)
        
        # –ü–æ–ª—É—á–∞–µ–º –≤–µ–∫—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ª–∞—Ç–µ–Ω—Ç–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ
        user_idx = self.user_item_matrix.index.get_loc(pair_id)
        user_vector = self.model.transform(self.user_item_matrix.iloc[[user_idx]])
        
        # –ü—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–π—Ç–∏–Ω–≥–∏ –¥–ª—è –≤—Å–µ—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤
        predicted_ratings = self.model.inverse_transform(user_vector)[0]
        
        # –£–±–∏—Ä–∞–µ–º —É–∂–µ –æ—Ü–µ–Ω–µ–Ω–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã
        user_ratings = self.user_item_matrix.iloc[user_idx]
        predicted_ratings[user_ratings > 0] = -1
        
        # –¢–æ–ø-K —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
        top_indices = predicted_ratings.argsort()[-top_k:][::-1]
        top_products = self.user_item_matrix.columns[top_indices]
        
        recommendations = []
        for i, product_id in enumerate(top_products):
            recommendations.append({
                'product_id': product_id,
                'predicted_rating': predicted_ratings[top_indices[i]],
                'cf_score': (predicted_ratings[top_indices[i]] + 5) / 10  # Normalize to 0-1
            })
        
        return recommendations
```

#### 3. **Embedding Service + ANN Search**

```python
# embedding_service.py
from sentence_transformers import SentenceTransformer
import faiss
import numpy as np

class EmbeddingService:
    def __init__(self, data_path: str):
        # Multilingual –º–æ–¥–µ–ª—å –¥–ª—è —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞
        self.model = SentenceTransformer('paraphrase-multilingual-MiniLM-L12-v2')
        self.dimension = 384
        
        # FAISS –∏–Ω–¥–µ–∫—Å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
        self.index = faiss.IndexFlatL2(self.dimension)
        self.product_ids = []
        
        self._build_product_embeddings(data_path)
    
    def _build_product_embeddings(self, data_path: str):
        """–°–æ–∑–¥–∞–µ–º –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤"""
        
        products_df = pd.read_csv(f"{data_path}/product_catalog.csv")
        
        # –°–æ–∑–¥–∞–µ–º —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è
        descriptions = []
        for _, product in products_df.iterrows():
            description = f"{product['name']} {product['category']} {product['tags']}"
            descriptions.append(description)
        
        # –í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
        embeddings = self.model.encode(descriptions, show_progress_bar=True)
        
        # –î–æ–±–∞–≤–ª—è–µ–º –≤ FAISS –∏–Ω–¥–µ–∫—Å
        self.index.add(embeddings.astype('float32'))
        self.product_ids = products_df['id'].tolist()
        
        print(f"Built embeddings for {len(descriptions)} products")
    
    def recommend(self, pair_id: str, top_k: int = 10):
        """–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –ø–æ—Ö–æ–∂–∏—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤"""
        
        # –°–æ–∑–¥–∞–µ–º –ø—Ä–æ—Ñ–∏–ª—å –ø–∞—Ä—ã
        pair_profile = self._build_pair_profile(pair_id)
        
        # –í–µ–∫—Ç–æ—Ä–∏–∑—É–µ–º –ø—Ä–æ—Ñ–∏–ª—å
        query_embedding = self.model.encode([pair_profile])
        
        # ANN –ø–æ–∏—Å–∫
        distances, indices = self.index.search(
            query_embedding.astype('float32'), top_k
        )
        
        recommendations = []
        for i, idx in enumerate(indices[0]):
            recommendations.append({
                'product_id': self.product_ids[idx],
                'similarity_score': 1 / (1 + distances[0][i]),  # Convert distance to similarity
                'semantic_distance': float(distances[0][i])
            })
        
        return recommendations
```

#### 4. **Learning to Rank**

```python
# learning_to_rank_service.py
import lightgbm as lgb

class LearningToRankService:
    def __init__(self, data_path: str):
        self.data_path = data_path
        self.model = None
        self.feature_names = []
        self._train_model()
    
    def _train_model(self):
        """–û–±—É—á–µ–Ω–∏–µ LightGBM Ranker"""
        
        # –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
        train_data = self._prepare_training_data()
        
        # –°–æ–∑–¥–∞–µ–º –¥–∞—Ç–∞—Å–µ—Ç –¥–ª—è —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è
        lgb_train = lgb.Dataset(
            train_data['features'],
            label=train_data['labels'],
            group=train_data['groups'],  # –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –ø–∞—Ä–∞–º
            feature_name=self.feature_names
        )
        
        # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏
        params = {
            'objective': 'lambdarank',
            'metric': 'ndcg',
            'ndcg_at': [1, 3, 5, 10],
            'num_leaves': 31,
            'learning_rate': 0.05,
            'feature_fraction': 0.9,
            'verbose': -1
        }
        
        # –û–±—É—á–µ–Ω–∏–µ —Å –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
        self.model = lgb.train(
            params,
            lgb_train,
            num_boost_round=100,
            valid_sets=[lgb_train],
            callbacks=[lgb.early_stopping(10), lgb.log_evaluation(0)]
        )
        
        print("LTR model trained successfully")
    
    def _prepare_training_data(self):
        """–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ñ–∏—á–µ–π –¥–ª—è –æ–±—É—á–µ–Ω–∏—è"""
        
        features = []
        labels = []
        groups = []
        
        # –ó–∞–≥—Ä—É–∂–∞–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
        interactions_df = pd.read_csv(f"{self.data_path}/interactions.csv")
        
        # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –ø–∞—Ä–∞–º
        for pair_id, group in interactions_df.groupby('pair_id'):
            pair_features = []
            pair_labels = []
            
            for _, interaction in group.iterrows():
                # –ò–∑–≤–ª–µ–∫–∞–µ–º 40+ —Ñ–∏—á–µ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
                feature_vector = self._extract_features(pair_id, interaction['product_id'])
                pair_features.append(feature_vector)
                pair_labels.append(interaction['rating'])
            
            features.extend(pair_features)
            labels.extend(pair_labels)
            groups.append(len(pair_features))
        
        return {
            'features': np.array(features),
            'labels': np.array(labels),
            'groups': np.array(groups)
        }
    
    def _extract_features(self, pair_id: str, product_id: str):
        """–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ 40+ —Ñ–∏—á–µ–π –¥–ª—è —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è"""
        
        features = []
        
        # 1. Content-based —Ñ–∏—á–∏
        cb_score = self.content_recommender.get_score(pair_id, product_id)
        features.extend([cb_score['interest_overlap'], cb_score['distance_score'], cb_score['price_match']])
        
        # 2. Collaborative filtering —Ñ–∏—á–∏
        cf_score = self.cf_recommender.get_score(pair_id, product_id)
        features.append(cf_score['predicted_rating'])
        
        # 3. Embedding —Ñ–∏—á–∏
        emb_score = self.embedding_service.get_score(pair_id, product_id)
        features.append(emb_score['similarity_score'])
        
        # 4. –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∏—á–∏
        features.extend([
            self._get_time_of_day_preference(pair_id),
            self._get_seasonality_score(product_id),
            self._get_weekday_preference(pair_id)
        ])
        
        # 5. –ü–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å –∏ –Ω–æ–≤–∏–∑–Ω–∞
        features.extend([
            self._get_product_popularity(product_id),
            self._get_product_novelty(product_id),
            self._get_user_exploration_tendency(pair_id)
        ])
        
        # ... –µ—â–µ 30+ —Ñ–∏—á–µ–π
        
        return features
    
    def recommend(self, pair_id: str, top_k: int = 10):
        """LTR —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤"""
        
        if not self.model:
            raise Exception("LTR model not trained")
        
        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –ø—Ä–æ–¥—É–∫—Ç—ã
        products_df = pd.read_csv(f"{self.data_path}/product_catalog.csv")
        
        # –ò–∑–≤–ª–µ–∫–∞–µ–º —Ñ–∏—á–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞
        features = []
        for _, product in products_df.iterrows():
            feature_vector = self._extract_features(pair_id, product['id'])
            features.append(feature_vector)
        
        # –ü—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ–º —Å–∫–æ—Ä—ã
        scores = self.model.predict(np.array(features))
        
        # –°–æ–∑–¥–∞–µ–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
        recommendations = []
        for i, (_, product) in enumerate(products_df.iterrows()):
            recommendations.append({
                'product_id': product['id'],
                'ltr_score': float(scores[i]),
                'rank': i + 1
            })
        
        # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —Å–∫–æ—Ä—É –∏ –±–µ—Ä–µ–º —Ç–æ–ø-K
        recommendations.sort(key=lambda x: x['ltr_score'], reverse=True)
        return recommendations[:top_k]
```

#### 5. **LLM Wrapper –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏**

```python
# llm_wrapper.py
class LLMWrapper:
    def __init__(self):
        self.model_name = "gpt-3.5-turbo"  # –∏–ª–∏ –¥—Ä—É–≥–∞—è –º–æ–¥–µ–ª—å
        self.templates = {
            'date_scenario': self._load_date_templates(),
            'gift_description': self._load_gift_templates(),
            'explanation': self._load_explanation_templates()
        }
    
    async def generate_date_scenario(self, pair_data: dict, product_data: dict):
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ü–µ–Ω–∞—Ä–∏—è —Å–≤–∏–¥–∞–Ω–∏—è"""
        
        prompt = f"""
        –°–æ–∑–¥–∞–π —Ä–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π —Å–≤–∏–¥–∞–Ω–∏—è –¥–ª—è –ø–∞—Ä—ã:
        
        –ò–Ω—Ç–µ—Ä–µ—Å—ã –ø–∞—Ä—ã: {pair_data['interests']}
        –ú–µ—Å—Ç–æ: {product_data['name']}
        –ö–∞—Ç–µ–≥–æ—Ä–∏—è: {product_data['category']}
        –ë—é–¥–∂–µ—Ç: {product_data['price']} —Ä—É–±.
        
        –°–æ–∑–¥–∞–π –ø–æ–¥—Ä–æ–±–Ω—ã–π –ø–ª–∞–Ω —Å–≤–∏–¥–∞–Ω–∏—è —Å –≤—Ä–µ–º–µ–Ω–Ω–æ–π —Å—Ö–µ–º–æ–π, –≤–∫–ª—é—á–∞—é—â–∏–π:
        1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫—É (—á—Ç–æ –≤–∑—è—Ç—å —Å —Å–æ–±–æ–π)
        2. –û—Å–Ω–æ–≤–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
        3. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–¥–µ–∏
        4. –†–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏
        
        –û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—Ä–∞–∫—Ç–∏—á–Ω—ã–º –∏ –≤–¥–æ—Ö–Ω–æ–≤–ª—è—é—â–∏–º.
        """
        
        response = await self._call_llm(prompt)
        return {
            'scenario': response,
            'generated_at': datetime.now().isoformat(),
            'model_used': self.model_name
        }
    
    async def explain_recommendation(self, recommendation_data: dict):
        """–û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ–Ω—è—Ç–Ω—ã–º —è–∑—ã–∫–æ–º"""
        
        prompt = f"""
        –û–±—ä—è—Å–Ω–∏ –ø—Ä–æ—Å—Ç—ã–º —è–∑—ã–∫–æ–º, –ø–æ—á–µ–º—É –º—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º —ç—Ç–æ –º–µ—Å—Ç–æ –¥–ª—è —Å–≤–∏–¥–∞–Ω–∏—è:
        
        –ù–∞–∑–≤–∞–Ω–∏–µ: {recommendation_data['product_name']}
        –°–∫–æ—Ä —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏: {recommendation_data['score']:.2f}
        –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã: {recommendation_data['reasons']}
        
        –°–æ–∑–¥–∞–π —Ç–µ–ø–ª–æ–µ, –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ (2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è).
        """
        
        response = await self._call_llm(prompt)
        return response
```

### üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏

```python
# monitoring_service.py
class MonitoringService:
    def __init__(self):
        self.metrics_storage = {}
        self.performance_log = []
    
    def track_recommendation_performance(self, request_data: dict, response_data: dict, processing_time: float):
        """–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π"""
        
        metric = {
            'timestamp': datetime.now().isoformat(),
            'pair_id': request_data['pair_id'],
            'method_used': response_data['method'],
            'processing_time_ms': processing_time,
            'recommendations_count': len(response_data['recommendations']),
            'cache_hit': response_data.get('from_cache', False)
        }
        
        self.performance_log.append(metric)
        
        # –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
        self._update_aggregated_metrics(metric)
    
    def get_system_health(self):
        """–ó–¥–æ—Ä–æ–≤—å–µ AI —Å–∏—Å—Ç–µ–º—ã"""
        
        recent_requests = [m for m in self.performance_log if 
                          datetime.fromisoformat(m['timestamp']) > datetime.now() - timedelta(hours=1)]
        
        if not recent_requests:
            return {'status': 'no_data', 'requests_last_hour': 0}
        
        avg_latency = np.mean([r['processing_time_ms'] for r in recent_requests])
        cache_hit_rate = np.mean([r['cache_hit'] for r in recent_requests])
        
        return {
            'status': 'healthy' if avg_latency < 1000 else 'degraded',
            'requests_last_hour': len(recent_requests),
            'avg_latency_ms': avg_latency,
            'cache_hit_rate': cache_hit_rate,
            'active_components': self._get_active_components()
        }
```

---

## üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ

### üåê –°—Ö–µ–º–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

```
     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      HTTP REST API       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
     ‚îÇ             ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂ ‚îÇ             ‚îÇ
     ‚îÇ   CLIENT    ‚îÇ                          ‚îÇ   SERVER    ‚îÇ
     ‚îÇ (React App) ‚îÇ‚óÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ (Node.js)   ‚îÇ
     ‚îÇ             ‚îÇ      JSON Responses      ‚îÇ             ‚îÇ
     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
            ‚îÇ                                         ‚îÇ
            ‚îÇ                                         ‚îÇ
            ‚îÇ WebSocket                               ‚îÇ HTTP API
            ‚îÇ Real-time                               ‚îÇ REST calls
            ‚îÇ                                         ‚îÇ
            ‚ñº                                         ‚ñº
     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
     ‚îÇ  Socket.io  ‚îÇ                          ‚îÇ     AI      ‚îÇ
     ‚îÇ   Server    ‚îÇ                          ‚îÇ  (Python)   ‚îÇ
     ‚îÇ             ‚îÇ                          ‚îÇ   FastAPI   ‚îÇ
     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### üìä –¢–∏–ø—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π

#### 1. **Client ‚Üî Server**

**HTTP REST API** –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π:
```typescript
// client/src/services/api.js
class ApiClient {
  async get(endpoint: string) {
    const response = await fetch(`${this.baseURL}${endpoint}`, {
      headers: {
        'Authorization': `Bearer ${this.token}`,
        'Content-Type': 'application/json'
      }
    })
    return response.json()
  }
  
  async post(endpoint: string, data: any) {
    const response = await fetch(`${this.baseURL}${endpoint}`, {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${this.token}`,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(data)
    })
    return response.json()
  }
}
```

**WebSocket** –¥–ª—è real-time —Ñ—É–Ω–∫—Ü–∏–π:
```typescript
// client/src/hooks/useGameSocket.ts
const useGameSocket = (roomId: string) => {
  const [socket, setSocket] = useState<Socket | null>(null)
  
  useEffect(() => {
    const socketInstance = io(SOCKET_URL, {
      auth: { token: user.token },
      transports: ['websocket', 'polling']
    })
    
    socketInstance.on('connect', () => {
      socketInstance.emit('join_room', roomId)
    })
    
    socketInstance.on('game_update', (gameState) => {
      setGameState(gameState)
    })
    
    setSocket(socketInstance)
    
    return () => socketInstance.disconnect()
  }, [roomId])
  
  const makeMove = useCallback((action: string, value: number) => {
    socket?.emit('make_move', { roomId, action, value })
  }, [socket, roomId])
  
  return { socket, makeMove }
}
```

#### 2. **Server ‚Üî AI**

**HTTP API** –¥–ª—è AI —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π:
```javascript
// server/controllers/recommendation.controller.js
class RecommendationController {
  async getRecommendations(req, res) {
    try {
      const { pairId, topK = 10 } = req.params
      
      // –í—ã–∑–æ–≤ Python AI —Å–µ—Ä–≤–∏—Å–∞
      const aiResponse = await axios.post(`${AI_SERVICE_URL}/recommend`, {
        pair_id: pairId,
        top_k: topK,
        user_location: req.body.location,
        context: {
          time_of_day: new Date().getHours(),
          day_of_week: new Date().getDay(),
          weather: req.body.weather
        },
        include_explanations: true,
        include_scenarios: true
      })
      
      const recommendations = aiResponse.data.recommendations
      
      // –û–±–æ–≥–∞—â–∞–µ–º –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ –ë–î
      const enrichedRecommendations = await this.enrichWithDatabaseData(recommendations)
      
      res.json({
        success: true,
        data: enrichedRecommendations,
        metadata: {
          generatedAt: new Date(),
          aiModelVersion: aiResponse.data.model_versions,
          processingTime: aiResponse.data.processing_time_ms
        }
      })
      
    } catch (error) {
      console.error('AI service error:', error)
      
      // Fallback –∫ –±–∞–∑–æ–≤—ã–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º
      const fallbackRecommendations = await this.getFallbackRecommendations(req.params.pairId)
      
      res.json({
        success: true,
        data: fallbackRecommendations,
        metadata: { fallback: true, reason: 'AI service unavailable' }
      })
    }
  }
}
```

#### 3. **–î–∞–Ω–Ω—ã–µ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**

**–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π**:
```
1. Client –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
   ‚Üì
2. Server –ø–æ–ª—É—á–∞–µ—Ç –∑–∞–ø—Ä–æ—Å + –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   ‚Üì
3. Server —Å–æ–±–∏—Ä–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–∞—Ä—ã –∏–∑ PostgreSQL
   ‚Üì
4. Server –≤—ã–∑—ã–≤–∞–µ—Ç AI —Å–µ—Ä–≤–∏—Å —Å –ø–æ–ª–Ω—ã–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
   ‚Üì
5. AI –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
   ‚Üì
6. Server –æ–±–æ–≥–∞—â–∞–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ –ë–î
   ‚Üì
7. Client –ø–æ–ª—É—á–∞–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ + –æ–±—ä—è—Å–Ω–µ–Ω–∏—è
```

**–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∏–≥—Ä**:
```
1. Client –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –∏–≥—Ä–æ–≤–æ–π –∫–æ–º–Ω–∞—Ç–µ —á–µ—Ä–µ–∑ WebSocket
   ‚Üì
2. Server —Å–æ–∑–¥–∞–µ—Ç/–Ω–∞—Ö–æ–¥–∏—Ç –∏–≥—Ä–æ–≤—É—é —Å–µ—Å—Å–∏—é
   ‚Üì
3. Client –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ö–æ–¥ —á–µ—Ä–µ–∑ WebSocket
   ‚Üì
4. Server –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ö–æ–¥ —á–µ—Ä–µ–∑ GameLogic
   ‚Üì
5. Server –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã –≤ Redis
   ‚Üì
6. Server –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ–º –∏–≥—Ä–æ–∫–∞–º
   ‚Üì
7. Client –æ–±–Ω–æ–≤–ª—è–µ—Ç UI –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
```

### üóÑÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏

#### 1. **PostgreSQL Schema**

```sql
-- –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
CREATE TABLE users (
    id UUID PRIMARY KEY,
    email VARCHAR UNIQUE NOT NULL,
    username VARCHAR UNIQUE NOT NULL,
    password_hash VARCHAR NOT NULL,
    coins INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT NOW()
);

CREATE TABLE pairs (
    id UUID PRIMARY KEY,
    user1_id UUID REFERENCES users(id),
    user2_id UUID REFERENCES users(id),
    status VARCHAR CHECK (status IN ('pending', 'active', 'ended')),
    created_at TIMESTAMP DEFAULT NOW()
);

CREATE TABLE events (
    id UUID PRIMARY KEY,
    pair_id UUID REFERENCES pairs(id),
    title VARCHAR NOT NULL,
    description TEXT,
    date_time TIMESTAMP,
    location VARCHAR,
    category VARCHAR,
    created_at TIMESTAMP DEFAULT NOW()
);

CREATE TABLE game_rooms (
    id UUID PRIMARY KEY,
    game_type VARCHAR NOT NULL,
    creator_id UUID REFERENCES users(id),
    settings JSONB,
    status VARCHAR DEFAULT 'waiting',
    max_players INTEGER,
    created_at TIMESTAMP DEFAULT NOW()
);

-- AI-related —Ç–∞–±–ª–∏—Ü—ã
CREATE TABLE recommendation_history (
    id UUID PRIMARY KEY,
    pair_id UUID REFERENCES pairs(id),
    product_id VARCHAR,
    score DECIMAL,
    method VARCHAR,
    created_at TIMESTAMP DEFAULT NOW()
);

CREATE TABLE ai_interactions (
    id UUID PRIMARY KEY,
    user_id UUID REFERENCES users(id),
    prompt TEXT,
    response TEXT,
    intent VARCHAR,
    created_at TIMESTAMP DEFAULT NOW()
);
```

#### 2. **Redis Caching Strategy**

```javascript
// server/services/cache.service.js
class CacheService {
  // –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–≥—Ä–æ–≤—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π
  async cacheGameState(roomId, gameState, ttl = 3600) {
    await redis.setex(`game:${roomId}`, ttl, JSON.stringify(gameState))
  }
  
  async getGameState(roomId) {
    const cached = await redis.get(`game:${roomId}`)
    return cached ? JSON.parse(cached) : null
  }
  
  // –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ AI —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
  async cacheRecommendations(pairId, recommendations, ttl = 1800) {
    const key = `recommendations:${pairId}`
    await redis.setex(key, ttl, JSON.stringify(recommendations))
  }
  
  async getRecommendations(pairId) {
    const cached = await redis.get(`recommendations:${pairId}`)
    return cached ? JSON.parse(cached) : null
  }
  
  // –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å–µ—Å—Å–∏–π
  async cacheUserSession(userId, sessionData, ttl = 86400) {
    await redis.setex(`session:${userId}`, ttl, JSON.stringify(sessionData))
  }
}
```

### üöÄ Deployment –∏ Production

#### 1. **Environment Configuration**

```javascript
// server/.env
NODE_ENV=production
PORT=5000

# Database
DATABASE_URL=postgresql://user:password@localhost:5432/lovememory
REDIS_URL=redis://localhost:6379

# JWT
JWT_SECRET=your-super-secret-key
JWT_EXPIRE=7d

# AI Service
AI_SERVICE_URL=http://localhost:8001
AI_GATEWAY_URL=https://your-ai-gateway.com

# External APIs
GOOGLE_CLIENT_ID=your-google-client-id
TELEGRAM_BOT_TOKEN=your-telegram-bot-token

# CORS
CLIENT_URL=https://your-frontend-domain.com
ALLOWED_ORIGINS=https://your-frontend-domain.com,https://admin.your-domain.com
```

```python
# ai/.env
# Database
DATABASE_URL=postgresql://user:password@localhost:5432/lovememory

# AI Models
HF_TOKEN=your-huggingface-token
OPENAI_API_KEY=your-openai-key

# Service
AI_SERVICE_PORT=8001
AI_SERVICE_HOST=0.0.0.0
```

#### 2. **Docker Configuration**

```yaml
# docker-compose.yml
version: '3.8'

services:
  client:
    build: ./client
    ports:
      - "3000:80"
    environment:
      - VITE_API_BASE_URL=http://server:5000
      - VITE_SOCKET_URL=http://server:5000
    depends_on:
      - server

  server:
    build: ./server
    ports:
      - "5000:5000"
    environment:
      - DATABASE_URL=postgresql://postgres:password@db:5432/lovememory
      - REDIS_URL=redis://redis:6379
      - AI_SERVICE_URL=http://ai:8001
    depends_on:
      - db
      - redis
      - ai

  ai:
    build: ./ai
    ports:
      - "8001:8001"
    environment:
      - DATABASE_URL=postgresql://postgres:password@db:5432
    volumes:
      - ./ai/models:/app/models
      - ./ai/data:/app/data
    depends_on:
      - db

  db:
    image: postgres:15
    environment:
      - POSTGRES_DB=lovememory
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=password
    volumes:
      - postgres_data:/var/lib/postgresql/data
    ports:
      - "5432:5432"

  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"

volumes:
  postgres_data:
```

### üîß –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

```javascript
// server/middleware/monitoring.middleware.js
const monitoringMiddleware = (req, res, next) => {
  const start = Date.now()
  
  res.on('finish', () => {
    const duration = Date.now() - start
    
    // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫
    console.log({
      method: req.method,
      url: req.url,
      status: res.statusCode,
      duration: `${duration}ms`,
      ip: req.ip,
      userAgent: req.get('User-Agent'),
      timestamp: new Date().toISOString()
    })
    
    // –û—Ç–ø—Ä–∞–≤–∫–∞ –º–µ—Ç—Ä–∏–∫ –≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
    if (duration > 1000) {
      console.warn(`Slow request: ${req.method} ${req.url} took ${duration}ms`)
    }
  })
  
  next()
}
```

---

## üìà –°–≤—è–∑—å —Å –ø–∞–ø–∫–æ–π AI

### üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–æ—á–∫–∏

#### 1. **Recommendation Engine Integration**

**Server ‚Üí AI** –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π:
```javascript
// server/services/ai.service.js
class AiService {
  async getRecommendations(pairId, options = {}) {
    const aiEndpoint = `${process.env.AI_SERVICE_URL}/recommend`
    
    const payload = {
      pair_id: pairId,
      top_k: options.topK || 10,
      user_location: options.location,
      context: {
        time_of_day: new Date().getHours(),
        day_of_week: new Date().getDay(),
        weather: options.weather,
        budget_range: options.budget
      },
      include_scenarios: true,
      include_explanations: true
    }
    
    try {
      const response = await axios.post(aiEndpoint, payload, {
        timeout: 5000,
        headers: { 'Content-Type': 'application/json' }
      })
      
      return {
        success: true,
        recommendations: response.data.recommendations,
        metadata: response.data.metadata,
        processingTime: response.data.processing_time_ms
      }
    } catch (error) {
      console.error('AI service error:', error.message)
      
      // Fallback –∫ –ø—Ä–æ—Å—Ç—ã–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º
      return this.getFallbackRecommendations(pairId, options)
    }
  }
}
```

**AI ‚Üí Server** –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
```python
# ai/ultimate_ai_service.py
@app.post("/recommend", response_model=RecommendationResponse)
async def get_recommendations(request: RecommendationRequest):
    start_time = time.time()
    
    try:
        # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –æ—Ç AI
        recommendations = await ai_service.get_recommendations(request)
        
        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ —á–µ—Ä–µ–∑ LLM
        if request.include_scenarios:
            for rec in recommendations:
                scenario = await llm_wrapper.generate_date_scenario(
                    request.pair_id, rec['product_id']
                )
                rec['scenario'] = scenario
        
        # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–π
        if request.include_explanations:
            explanations = explainer.explain_recommendations(recommendations)
            for i, explanation in enumerate(explanations):
                recommendations[i]['explanation'] = explanation
        
        processing_time = (time.time() - start_time) * 1000
        
        return RecommendationResponse(
            recommendations=recommendations,
            metadata={
                'total_count': len(recommendations),
                'method_used': ai_service.last_method_used,
                'cache_hit': False
            },
            processing_time_ms=processing_time,
            model_versions=ai_service.get_model_versions()
        )
        
    except Exception as e:
        logger.error(f"Recommendation error: {e}")
        raise HTTPException(status_code=500, detail=str(e))
```

#### 2. **Chat Integration**

**Client** –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –≤ AI —á–∞—Ç:
```typescript
// client/src/hooks/useAIChat.ts
const useAIChat = () => {
  const [messages, setMessages] = useState([])
  const [isLoading, setIsLoading] = useState(false)
  
  const sendMessage = async (prompt: string) => {
    setIsLoading(true)
    
    try {
      const response = await api.post('/intelligence/chat', { prompt })
      
      const aiMessage = {
        id: generateId(),
        text: response.data.message,
        sender: 'ai',
        timestamp: new Date(),
        intent: response.data.intent,
        suggestions: response.data.suggestions
      }
      
      setMessages(prev => [...prev, aiMessage])
    } catch (error) {
      console.error('AI chat error:', error)
    } finally {
      setIsLoading(false)
    }
  }
  
  return { messages, sendMessage, isLoading }
}
```

**Server** –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —á–µ—Ä–µ–∑ AI Orchestrator:
```javascript
// server/controllers/intelligence.controller.ts
export const handleChat = async (req: AuthenticatedRequest, res: Response) => {
  try {
    const { prompt } = req.body
    const userId = req.user?.id
    
    // –°–±–æ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    const context = await userContextService.buildContext(userId)
    
    // –û–±—Ä–∞—â–µ–Ω–∏–µ –∫ AI Orchestrator
    const response = await aiOrchestrator.handleRequest(prompt, userId)
    
    res.json({
      success: true,
      data: {
        message: response.message,
        intent: response.intent,
        confidence: response.confidence,
        suggestions: response.suggestions,
        data: response.data
      }
    })
  } catch (error) {
    res.status(500).json({ success: false, error: error.message })
  }
}
```

#### 3. **Data Flow –¥–ª—è Machine Learning**

**–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö** –∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è –æ–±—É—á–µ–Ω–∏—è:
```javascript
// server/services/analytics.service.js
class AnalyticsService {
  async trackUserInteraction(userId, action, data) {
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –ë–î –¥–ª—è AI
    await ActivityLog.create({
      userId,
      action,
      data: JSON.stringify(data),
      timestamp: new Date()
    })
    
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ AI –¥–ª—è online learning
    if (this.shouldSendToAI(action)) {
      await this.sendToAIService({
        user_id: userId,
        interaction_type: action,
        interaction_data: data,
        timestamp: new Date().toISOString()
      })
    }
  }
  
  async sendToAIService(interactionData) {
    try {
      await axios.post(`${AI_SERVICE_URL}/learn`, interactionData)
    } catch (error) {
      console.error('Failed to send data to AI:', error)
      // –ù–µ –∫—Ä–∏—Ç–∏—á–Ω–æ, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–∞–±–æ—Ç—É
    }
  }
}
```

**AI —Å–∏—Å—Ç–µ–º–∞** –ø–æ–ª—É—á–∞–µ—Ç –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å:
```python
# ai/monitoring_service.py
@app.post("/learn")
async def receive_user_feedback(interaction: UserInteraction):
    """–ü–æ–ª—É—á–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ –¥–ª—è online learning"""
    
    try:
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ
        await save_interaction_to_db(interaction)
        
        # –û–±–Ω–æ–≤–ª—è–µ–º –º–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞
        if interaction.interaction_type == 'recommendation_click':
            await update_recommendation_metrics(
                interaction.user_id,
                interaction.interaction_data['product_id'],
                positive_feedback=True
            )
        
        # –¢—Ä–∏–≥–≥–µ—Ä–∏–º –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
        if should_retrain():
            await trigger_model_retraining()
        
        return {"status": "success", "message": "Feedback received"}
        
    except Exception as e:
        logger.error(f"Error processing feedback: {e}")
        raise HTTPException(status_code=500, detail=str(e))
```

### üéØ –†–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∞—è —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞

**–ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã:**

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å** –∑–∞—Ö–æ–¥–∏—Ç –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Üí **Client** (React)
2. **Client** –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ ‚Üí **Server** (Node.js)
3. **Server** —Å–æ–±–∏—Ä–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Üí **PostgreSQL**
4. **Server** –≤—ã–∑—ã–≤–∞–µ—Ç AI —Å–µ—Ä–≤–∏—Å ‚Üí **AI** (Python FastAPI)
5. **AI** –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ ML –º–æ–¥–µ–ª–∏ ‚Üí **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**
6. **AI** –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ–±—ä—è—Å–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ LLM ‚Üí **–°—Ü–µ–Ω–∞—Ä–∏–∏ —Å–≤–∏–¥–∞–Ω–∏–π**
7. **Server** –æ–±–æ–≥–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –ë–î ‚Üí **–ü–æ–ª–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**
8. **Client** –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ ‚Üí **UI**
9. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å** –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ ‚Üí **Feedback**
10. **System** –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –≤ AI ‚Üí **Continuous Learning**

---

**–°–∏—Å—Ç–µ–º–∞ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∞ –∫–∞–∫ –µ–¥–∏–Ω–∞—è —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞, –≥–¥–µ –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏–º–µ–µ—Ç —á–µ—Ç–∫—É—é –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å, –Ω–æ –≤—Å–µ —Ä–∞–±–æ—Ç–∞—é—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è seamless –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –æ–ø—ã—Ç–∞.**

